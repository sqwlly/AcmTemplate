/*************************************************************************
    > File Name: fwt01.cpp
fwt(a) * fwt(b) = fwt(c)
TA * TB = TC
T_0 = 1, T_1 = [1, -1]^-1 = [0.5,  0.5]
			   [1,  1]      [-0.5, 0.5]

			   [1,  1]^-1 = [0.5,  0.5]
			   [1, -1]    = [0.5, -0.5]
 ************************************************************************/
void fwt(LL *a) {
    for (int i = 1; 1 << i <= n; i++) {
        for (int j = 0; j < n; j += 1 << i) {
            for (int k = 0; k < 1 << (i - 1); k++) {
                LL x = a[j + k];
                LL y = a[j + k + (1 << (i - 1))];
                a[j + k] = (x + y) % p;
                a[j + k + (1 << (i - 1))] = (x + p - y) % p;
            }
        }
    }
}

